SELECT

                PN.COD_TIPO_IDENTIFICACION

,              PN.IDENTIFICACION

,              PN.SEC_PERSONA

,              PN.PRIMER_NOMBRE

,              PN.SEGUNDO_NOMBRE

,              PN.APELLIDO_PATERNO

,              PN.APELLIDO_MATERNO

,              PN.FCH_NACIMIENTO

,              EC.ESTADO_CIVIL

,              PN.SEXO

,              PN.SEC_PROFESION

,              'A' NIVEL_EDUCACION

,              PN.COD_OCUPACION

,              (SELECT A.PRIMER_NOMBRE || ',' || A.SEGUNDO_NOMBRE || ',' ||    A.APELLIDO_PATERNO || ',' ||                A.APELLIDO_MATERNO

                FROM equivida.RELACION B INNER JOIN equivida.PERSONA_NATURAL  A ON B.SEC_PERSONA_RELACION = A.SEC_PERSONA WHERE B.COD_TIPO_PARENTESCO IN (15) AND B.SEC_PERSONA_PRINCIPAL = PN.SEC_PERSONA)

,              PN.NUM_HIJOS

,              CP.HORA_INICIO_CONTACTO

,              CP.HORA_FIN_CONTACTO

,              ' ' TIPO_EMPLEO

, (SELECT NEGOCIO_EMPRESA || ',' || CARGO

                FROM equivida.EMPLEO_DEPENDIENTE A

                WHERE A.SEC_PERSONA_NATURAL = PN.SEC_PERSONA_NATURAL

                AND A.SEC_EMPLEO_DEPENDIENTE IN

                               (SELECT MAX(X.SEC_EMPLEO_DEPENDIENTE) FROM  equivida.EMPLEO_DEPENDIENTE X WHERE A.SEC_PERSONA_NATURAL = X.SEC_PERSONA_NATURAL)) DEPENDIENTE

, (SELECT ' ' || ',' || CARGO FROM equivida.EMPLEO_INDEPENDIENTE A WHERE A.SEC_PERSONA_NATURAL = PN.SEC_PERSONA_NATURAL AND

                A.SEC_EMPLEO_INDEPENDIENTE = (SELECT MAX(X.SEC_EMPLEO_INDEPENDIENTE) FROM  equivida.EMPLEO_INDEPENDIENTE X WHERE A.SEC_PERSONA_NATURAL = X.SEC_PERSONA_NATURAL)) INDEPENDIENTE

, (SELECT DIRECCION_ELECTRONICA  FROM equivida.DIRECCION_ELECTRONICA  A WHERE  COD_TIPO_DIRECCION_ELECTRONICA = 1

                AND SEC_DIRECCION_ELECTRONICA = (SELECT MAX(X.SEC_DIRECCION_ELECTRONICA) FROM equivida.DIRECCION_ELECTRONICA X WHERE X.SEC_PERSONA = A.SEC_PERSONA) AND A.SEC_PERSONA = PN.SEC_PERSONA

                ) EMAIL

, (SELECT DIRECCION_ELECTRONICA  FROM equivida.DIRECCION_ELECTRONICA  A WHERE  COD_TIPO_DIRECCION_ELECTRONICA = 2

                AND SEC_DIRECCION_ELECTRONICA = (SELECT MAX(X.SEC_DIRECCION_ELECTRONICA) FROM equivida.DIRECCION_ELECTRONICA X WHERE X.SEC_PERSONA = A.SEC_PERSONA) AND A.SEC_PERSONA = PN.SEC_PERSONA

                ) EMAIL_ALTERNO

, 'DOMICILIO' TIPO_DIR 

 

, (SELECT

P.COD_PAIS 

|| ',' ||  ''  

|| ',' || P.SEC_PROVINCIA 

|| ',' || D.SEC_CANTON 

|| ',' || D.CIUDAD 

|| ',' || '' 

|| ',' || D.BARRIO  

|| ',' || D.PRINCIPAL

|| ',' || D.NUMERO 

|| ',' || D.SECUNDARIA 

|| ',' || D.EDIFICIO 

|| ',' || D.LONGITUD 

|| ',' || D.LATITUD 

|| ',' || D.REFERENCIA

FROM equivida.DIRECCION D

                LEFT JOIN equivida.CANTON C

                               ON D.SEC_CANTON = C.SEC_CANTON

                LEFT JOIN equivida.PROVINCIA P

                               ON P.SEC_PROVINCIA = C.SEC_PROVINCIA

WHERE  D.SEC_DIRECCION IN (SELECT MAX(X.SEC_DIRECCION) FROM equivida.DIRECCION  X WHERE X.SEC_PERSONA = D.SEC_PERSONA) AND D.SEC_PERSONA = PN.SEC_PERSONA) DIRECCION

 

, 'DOMICILIO' TIP_TELEF

, (

SELECT

  T.COD_PAIS

|| ',' || T.COD_AREA

|| ',' || T.NRO_TELEFONO

|| ',' || T.EXT_TELEFONO

FROM equivida.TELEFONO T WHERE

T.SEC_TELEFONO  IN (SELECT MAX(X.SEC_TELEFONO) FROM equivida.TELEFONO X WHERE X.SEC_PERSONA = T.SEC_PERSONA)

AND T.SEC_PERSONA = PN.SEC_PERSONA

) TELEFONO

, PN.PRIMER_NOMBRE || ' ' || PN.APELLIDO_PATERNO CONTACTO

, (SELECT DIRECCION_ELECTRONICA  FROM equivida.DIRECCION_ELECTRONICA  A WHERE  COD_TIPO_DIRECCION_ELECTRONICA = 2

                AND SEC_DIRECCION_ELECTRONICA = (SELECT MIN(X.SEC_DIRECCION_ELECTRONICA) FROM equivida.DIRECCION_ELECTRONICA X WHERE X.SEC_PERSONA = A.SEC_PERSONA) AND A.SEC_PERSONA = PN.SEC_PERSONA

                ) EMAIL_CONTACTO     

 

, IM.MNT_INGRESO_MENSUAL

FROM equivida.PERSONA_NATURAL PN

                               LEFT JOIN equivida.ESTADO_CIVIL EC

                                               ON PN.COD_ESTADO_CIVIL = EC.COD_ESTADO_CIVIL

                               LEFT JOIN equivida.CONTACTO_PREFERIDO CP

                                               ON PN.SEC_PERSONA = CP.SEC_PERSONA

                               LEFT JOIN equivida.INGRESO_MENSUAL IM

                                               ON PN.SEC_PERSONA_NATURAL = IM.SEC_PERSONA_NATURAL

WHERE PN.SEC_PERSONA = 2312512